package com.rover.ui.components\n\nimport androidx.compose.foundation.background\nimport androidx.compose.foundation.gestures.detectDragGestures\nimport androidx.compose.foundation.layout.*\nimport androidx.compose.foundation.shape.CircleShape\nimport androidx.compose.material3.MaterialTheme\nimport androidx.compose.material3.Surface\nimport androidx.compose.material3.Text\nimport androidx.compose.runtime.*\nimport androidx.compose.ui.Alignment\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.draw.clip\nimport androidx.compose.ui.graphics.Color\nimport androidx.compose.ui.input.pointer.pointerInput\nimport androidx.compose.ui.unit.dp\nimport kotlin.math.sqrt\n\n/**\n * Virtual Joystick Component\n */\n@Composable\nfun JoystickView(\n    onMotorCommand: (String) -> Unit,\n    modifier: Modifier = Modifier\n) {\n    var touchX by remember { mutableStateOf(0f) }\n    var touchY by remember { mutableStateOf(0f) }\n    \n    val joystickRadius = 100f\n    val handleRadius = 30f\n    \n    Box(\n        modifier = modifier\n            .clip(CircleShape)\n            .background(MaterialTheme.colorScheme.surfaceVariant)\n            .pointerInput(Unit) {\n                detectDragGestures(\n                    onDrag = { change, _ ->\n                        val x = change.position.x - 125f\n                        val y = change.position.y - 125f\n                        \n                        val distance = sqrt(x * x + y * y)\n                        if (distance <= joystickRadius) {\n                            touchX = x\n                            touchY = y\n                        } else {\n                            val angle = kotlin.math.atan2(y, x)\n                            touchX = joystickRadius * kotlin.math.cos(angle)\n                            touchY = joystickRadius * kotlin.math.sin(angle)\n                        }\n                        \n                        // Calculate motor command\n                        val command = calculateMotorCommand(touchX, touchY)\n                        onMotorCommand(command)\n                    },\n                    onDragEnd = {\n                        touchX = 0f\n                        touchY = 0f\n                        onMotorCommand(\"STOP\")\n                    }\n                )\n            },\n        contentAlignment = Alignment.Center\n    ) {\n        // Background circle\n        Surface(\n            modifier = Modifier\n                .size(200.dp)\n                .clip(CircleShape),\n            color = MaterialTheme.colorScheme.surface,\n            shadowElevation = 4.dp\n        ) {}\n        \n        // Center point\n        Surface(\n            modifier = Modifier\n                .size(20.dp)\n                .clip(CircleShape),\n            color = MaterialTheme.colorScheme.primary\n        ) {}\n        \n        // Joystick handle\n        Surface(\n            modifier = Modifier\n                .offset(\n                    x = (touchX / joystickRadius * 60).dp,\n                    y = (touchY / joystickRadius * 60).dp\n                )\n                .size(60.dp)\n                .clip(CircleShape),\n            color = MaterialTheme.colorScheme.primary,\n            shadowElevation = 8.dp\n        ) {}\n    }\n}\n\nprivate fun calculateMotorCommand(x: Float, y: Float): String {\n    val threshold = 20f\n    \n    return when {\n        y < -threshold && kotlin.math.abs(x) < threshold -> \"FORWARD\"\n        y > threshold && kotlin.math.abs(x) < threshold -> \"BACKWARD\"\n        x < -threshold && kotlin.math.abs(y) < threshold -> \"LEFT\"\n        x > threshold && kotlin.math.abs(y) < threshold -> \"RIGHT\"\n        else -> \"STOP\"\n    }\n}\n\n/**\n * Video Display Component\n */\n@Composable\nfun VideoView(\n    modifier: Modifier = Modifier\n) {\n    Surface(\n        modifier = modifier,\n        color = Color.Black,\n        shape = MaterialTheme.shapes.medium\n    ) {\n        Box(\n            modifier = Modifier.fillMaxSize(),\n            contentAlignment = Alignment.Center\n        ) {\n            Text(\n                text = \"Video Stream\",\n                color = Color.White,\n                style = MaterialTheme.typography.bodyMedium\n            )\n        }\n    }\n}\n\n/**\n * Status Bar Component\n */\n@Composable\nfun StatusBar(\n    connectionStatus: String,\n    fps: Int,\n    latency: Int,\n    modifier: Modifier = Modifier\n) {\n    Surface(\n        modifier = modifier,\n        color = MaterialTheme.colorScheme.surfaceVariant,\n        shape = MaterialTheme.shapes.small\n    ) {\n        Row(\n            modifier = Modifier\n                .padding(12.dp)\n                .fillMaxWidth(),\n            horizontalArrangement = Arrangement.SpaceEvenly,\n            verticalAlignment = Alignment.CenterVertically\n        ) {\n            StatusItem(\"Status\", connectionStatus)\n            StatusItem(\"FPS\", \"$fps\")\n            StatusItem(\"Latency\", \"${latency}ms\")\n        }\n    }\n}\n\n@Composable\nfun StatusItem(label: String, value: String) {\n    Column(\n        horizontalAlignment = Alignment.CenterHorizontally\n    ) {\n        Text(\n            text = label,\n            style = MaterialTheme.typography.labelSmall,\n            color = MaterialTheme.colorScheme.onSurfaceVariant\n        )\n        Text(\n            text = value,\n            style = MaterialTheme.typography.labelMedium,\n            color = MaterialTheme.colorScheme.primary\n        )\n    }\n}\n
