package com.rover.ui.screens\n\nimport androidx.compose.foundation.background\nimport androidx.compose.foundation.layout.*\nimport androidx.compose.material.icons.Icons\nimport androidx.compose.material.icons.filled.Info\nimport androidx.compose.material.icons.filled.Settings\nimport androidx.compose.material3.*\nimport androidx.compose.runtime.*\nimport androidx.compose.ui.Alignment\nimport androidx.compose.ui.Modifier\nimport androidx.compose.ui.graphics.Color\nimport androidx.compose.ui.unit.dp\nimport com.rover.ui.components.JoystickView\nimport com.rover.ui.components.StatusBar\nimport com.rover.ui.components.VideoView\nimport timber.log.Timber\n\n@Composable\nfun ControlScreen(\n    roverAddress: String,\n    onDisconnect: () -> Unit\n) {\n    var showStats by remember { mutableStateOf(false) }\n    var connectionStatus by remember { mutableStateOf(\"Connecting...\") }\n    var fps by remember { mutableStateOf(0) }\n    var latency by remember { mutableStateOf(0) }\n    \n    LaunchedEffect(Unit) {\n        // Simulate connection\n        connectionStatus = \"Connected\"\n        Timber.d(\"Connected to $roverAddress\")\n    }\n    \n    Column(\n        modifier = Modifier\n            .fillMaxSize()\n            .background(MaterialTheme.colorScheme.background)\n    ) {\n        // Top App Bar\n        TopAppBar(\n            title = { Text(\"Rover Control - $roverAddress\") },\n            actions = {\n                IconButton(onClick = { showStats = !showStats }) {\n                    Icon(Icons.Filled.Info, contentDescription = \"Stats\")\n                }\n                IconButton(onClick = { /* Settings */ }) {\n                    Icon(Icons.Filled.Settings, contentDescription = \"Settings\")\n                }\n            },\n            modifier = Modifier.fillMaxWidth()\n        )\n        \n        // Main Content\n        Box(\n            modifier = Modifier\n                .fillMaxSize()\n                .padding(12.dp)\n        ) {\n            Column(\n                modifier = Modifier.fillMaxSize(),\n                horizontalAlignment = Alignment.CenterHorizontally\n            ) {\n                // Video Display Area\n                VideoView(\n                    modifier = Modifier\n                        .fillMaxWidth()\n                        .height(280.dp)\n                        .background(Color.Black)\n                )\n                \n                Spacer(modifier = Modifier.height(12.dp))\n                \n                // Status Bar\n                StatusBar(\n                    connectionStatus = connectionStatus,\n                    fps = fps,\n                    latency = latency,\n                    modifier = Modifier.fillMaxWidth()\n                )\n                \n                Spacer(modifier = Modifier.height(12.dp))\n                \n                // Joystick Control\n                JoystickView(\n                    onMotorCommand = { command ->\n                        Timber.d(\"Motor command: $command\")\n                    },\n                    modifier = Modifier\n                        .size(250.dp)\n                        .align(Alignment.CenterHorizontally)\n                )\n                \n                Spacer(modifier = Modifier.height(12.dp))\n                \n                // Control Buttons\n                Row(\n                    modifier = Modifier\n                        .fillMaxWidth()\n                        .padding(horizontal = 8.dp),\n                    horizontalArrangement = Arrangement.spacedBy(8.dp)\n                ) {\n                    Button(\n                        onClick = { /* Emergency Stop */ },\n                        modifier = Modifier\n                            .weight(1f)\n                            .height(48.dp),\n                        colors = ButtonDefaults.buttonColors(\n                            containerColor = MaterialTheme.colorScheme.error\n                        )\n                    ) {\n                        Text(\"STOP\")\n                    }\n                    \n                    OutlinedButton(\n                        onClick = { /* Switch Camera */ },\n                        modifier = Modifier\n                            .weight(1f)\n                            .height(48.dp)\n                    ) {\n                        Text(\"Camera\")\n                    }\n                    \n                    OutlinedButton(\n                        onClick = { onDisconnect() },\n                        modifier = Modifier\n                            .weight(1f)\n                            .height(48.dp)\n                    ) {\n                        Text(\"Disconnect\")\n                    }\n                }\n            }\n            \n            // Stats Panel (Overlay)\n            if (showStats) {\n                Surface(\n                    modifier = Modifier\n                        .align(Alignment.TopEnd)\n                        .padding(8.dp),\n                    color = MaterialTheme.colorScheme.surfaceVariant,\n                    shape = MaterialTheme.shapes.medium\n                ) {\n                    Column(\n                        modifier = Modifier.padding(12.dp)\n                    ) {\n                        Text(\n                            text = \"Statistics\",\n                            style = MaterialTheme.typography.labelLarge,\n                            modifier = Modifier.padding(bottom = 8.dp)\n                        )\n                        \n                        StatItem(\"Status\", connectionStatus)\n                        StatItem(\"FPS\", \"$fps\")\n                        StatItem(\"Latency\", \"${latency}ms\")\n                        StatItem(\"Bitrate\", \"1.2 Mbps\")\n                        StatItem(\"Resolution\", \"1280x720\")\n                        \n                        Divider(modifier = Modifier.padding(vertical = 8.dp))\n                        \n                        Button(\n                            onClick = { showStats = false },\n                            modifier = Modifier\n                                .align(Alignment.End)\n                                .height(32.dp),\n                            contentPadding = PaddingValues(horizontal = 12.dp, vertical = 4.dp)\n                        ) {\n                            Text(\"Close\")\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\n@Composable\nfun StatItem(label: String, value: String) {\n    Row(\n        modifier = Modifier\n            .fillMaxWidth()\n            .padding(vertical = 4.dp),\n        horizontalArrangement = Arrangement.SpaceBetween\n    ) {\n        Text(\n            text = label,\n            style = MaterialTheme.typography.labelSmall\n        )\n        Text(\n            text = value,\n            style = MaterialTheme.typography.labelSmall,\n            color = MaterialTheme.colorScheme.primary\n        )\n    }\n}\n
